(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{576:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("Script Executor应用存在这样一个场景：Script Executor调度一个Server去执行一个SQL语句，查询出数据并做处理。")]),s._v(" "),t("p",[s._v("为了简化，这里使用一个典型例子：")]),s._v(" "),t("p",[t("strong",[s._v("场景：")])]),s._v(" "),t("ol",[t("li",[t("p",[s._v("MySQL服务器地址：192.168.3.3:3306")])]),s._v(" "),t("li",[t("p",[s._v("在test库存在一张表："),t("code",[s._v("test.user")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img-1252535357.cos.ap-chengdu.myqcloud.com/blog/shell-mysql/1.jpg",alt:"test.user"}})])]),s._v(" "),t("li",[t("p",[s._v("MySQL命令行工具或者包含MySQL命令行工具的docker镜像（arey/mysql-client）")])])]),s._v(" "),t("p",[t("strong",[s._v("需求:")])]),s._v(" "),t("p",[s._v("查询出"),t("code",[s._v("test.test")]),s._v("表的数据并格式化输出。")]),s._v(" "),t("p",[t("strong",[s._v("方案一：使用MySQL命令行并指定语句")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" name bd\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" I"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("`m "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${name}")]),s._v(", I was born on "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bd}")]),s._v(", and my ID is "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${id}")]),s._v("\ndone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mysql -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.3 -uroot -proot -Dtest -P3306 -s -N -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"select id, name, birthday from test.user"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("方案二：使用MySQL命令行并指定SQL文件")])]),s._v(" "),t("ol",[t("li",[t("p",[s._v("新建"),t("code",[s._v("query.sql")]),s._v("文件，内容为")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" birthday "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("使用sql文件来执行命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" name bd\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" I"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("`m "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${name}")]),s._v(", I was born on "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bd}")]),s._v(", and my ID is "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${id}")]),s._v("\ndone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mysql -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.3 -uroot -proot -Dtest -P3306 -s -N -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source /sql/query.sql"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])]),s._v(" "),t("p",[t("strong",[s._v("方案三：使用Docker并指定语句")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" name bd\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" I"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("`m "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${name}")]),s._v(", I was born on "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bd}")]),s._v(", and my ID is "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${id}")]),s._v("\ndone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("docker run --rm -v /home/neilw/sql:/sql arey/mysql-client -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.3 -uroot -proot -Dtest -P3306 -s -N -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"select id, name, birthday from test.user"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("方案四：使用Docker并指定SQL文件")])]),s._v(" "),t("p",[s._v("使用方案二的"),t("code",[s._v("query.sql")]),s._v("文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" name bd\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" I"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("`m "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${name}")]),s._v(", I was born on "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bd}")]),s._v(", and my ID is "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${id}")]),s._v("\ndone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("docker run --rm -v /home/neilw/sql:/sql arey/mysql-client -h "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.3 -uroot -proot -Dtest -P3306 -s -N -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source /sql/query.sql"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("之所以有使用Docker这个方案是因为有的机器上没有安装"),t("code",[s._v("mysql-client")]),s._v("的权限，只能使用Docker来达到使用"),t("code",[s._v("mysql-client")]),s._v("的目的。")]),s._v(" "),t("p",[t("strong",[s._v("四种方案的效果都为：")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img-1252535357.cos.ap-chengdu.myqcloud.com/blog/shell-mysql/2.jpg",alt:"res"}})]),s._v(" "),t("p",[t("strong",[s._v("注意：")])]),s._v(" "),t("ol",[t("li",[s._v("在docker方案中，加上"),t("code",[s._v("--rm")]),s._v("参数，使docker在运行之后自动删除容器")]),s._v(" "),t("li",[s._v("在docker方案中，***不要***加"),t("code",[s._v("-ti")]),s._v("参数，否则输出会乱")]),s._v(" "),t("li",[t("code",[s._v("done")]),s._v("和"),t("code",[s._v("<")]),s._v("中没有空格，两个"),t("code",[s._v("<")]),s._v("之间有一个空格，后面的"),t("code",[s._v("<")]),s._v("和命令之间没有空格")])]),s._v(" "),t("br"),s._v(" "),t("hr"),s._v(" "),t("br"),s._v(" "),t("Vssue",{attrs:{title:s.$title}})],1)}),[],!1,null,null,null);a.default=n.exports}}]);