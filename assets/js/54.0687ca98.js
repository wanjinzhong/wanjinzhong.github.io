(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{568:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("有一个项目需要在本地为前端同学启应用环境，但是代码合并了之后老是需要我手动去停掉本地环境，拉最新的代码，再启动环境。这不符合我的做事风格。于是，准备使用Cron来实现这个功能。大致思路如下：写个脚本，调用DEV环境和本地环境的查看版本API，进行对比，如果不同则重新拉去最新代码重启，再把这个脚本加入Cron中。这里主要记录如何把这个脚本加入Cron中。")]),s._v(" "),t("h2",{attrs:{id:"_1-ubuntu上在自己的用户下打开并编辑crontab文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ubuntu上在自己的用户下打开并编辑crontab文件"}},[s._v("#")]),s._v(" 1. Ubuntu上在自己的用户下打开并编辑Crontab文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -e\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_2-编写一行cron-任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-编写一行cron-任务"}},[s._v("#")]),s._v(" 2. 编写一行cron 任务")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# m h  dom mon dow   command")]),s._v("\n*/10 * * * * xxx.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("说明:minute (m), hour (h), day of month (dom), month (mon) and day of week (dow) or use ‘"),t("em",[s._v("’ in these fields (for ‘any’).")]),s._v("\n比如："),t("code",[s._v("* * * * * xxx.sh")]),s._v(" 表示每分钟执行一次， "),t("code",[s._v("1 * * * * xxx.sh")]),s._v(" 表示每小时的1分钟的时候执行一次，"),t("code",[s._v("*/10 * * * * xxx.sh")]),s._v("表示每10分钟执行一次")]),s._v(" "),t("h2",{attrs:{id:"_3-重启crontab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-重启crontab"}},[s._v("#")]),s._v(" 3. 重启crontab")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" restart\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"_4-查看crontab状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-查看crontab状态"}},[s._v("#")]),s._v(" 4. 查看crontab状态")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" status\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("hr"),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"title"},[s._v("注意")]),t("p",[s._v("Ubuntu默认没有开启Cron日志，最好开启，编辑/etc/rsyslog.d/50-default.conf")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/rsyslog.d/50-default.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("把cron.* /var/log/cron.log的注释取消并保存\n最好将自己脚本的日志文件输出到自己指定的地方，比如：")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# m h  dom mon dow   command")]),s._v("\n*/10 * * * * /home/neilw/cron/script/plm2-test-cron.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /home/neilw/cron/logs/plm2-test-cron.log\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),t("br"),s._v(" "),t("hr"),s._v(" "),t("br"),s._v(" "),t("Vssue",{attrs:{title:s.$title}})],1)}),[],!1,null,null,null);a.default=n.exports}}]);